# GBSC Clusters Functional Analysis

Tools for functional analysis of protein clusters generated by GBSC (Graph Based Sequence Clustering).

## Description

This project contains Python scripts for:
- Downloading Gene Ontology (GO) annotations for proteins from GBSC clusters
- Performing statistical functional analysis of clusters
- Generating analysis reports

## Requirements

- Python 3.7+
- Libraries: `requests`, `pandas`, `numpy`, `scipy`


## Usage

### Step 1: Download GO Annotations

```bash
python 01_download_go.py \
  --input=./input/gbsc_protein_ids.txt \
  --exclude_IEA=no \
  --aspect=F \
  --project_dir=./results/
```

**Parameters:**
- `--input`: Input file with protein IDs (one ID per line)
- `--exclude_IEA=no`: Whether to exclude IEA (Inferred from Electronic Annotation) annotations (yes/no)
- `--aspect=F`: GO aspect (F=molecular function, P=biological process, C=cellular component)
- `--ouput_dir`: Output directory for results

### Step 2: Functional Analysis

```bash
python 02_gbsc_functional_analysis.py \
  --gbsc_clusters=./path/to/clusters/ \
  --alpha=0.05 \
  --ouput_dir=./results/ \
  --log_file=gbsc_functional_analysis.log
```

**Parameters:**
- `--gbsc_clusters` / `-c`: Path to directory with GBSC clusters
- `--alpha` / `-a`: Threshold of test significance (default: 0.05)
- `--ouput_dir` / `-o`: Output directory (should match the one from step 1)
- `--log_file` / `-l`: Log file name (default: gbsc_functional_analysis.log)

## Project Structure

```
.
.
├── 01_download_go.py                 # Download GO annotations
├── 02_gbsc_functional_analysis.py    # Statistical functional analysis
├── input/
│   ├── gbsc_protein_ids.txt          # Protein IDs for analysis
│   └── clusters_acc/                 # Directories with GBSC clusters
├── src/                              # Python helper scripts  
├── results/                          # Output results directory
└── README.md

```

## Workflow

1. Prepare GBSC clusters and protein ID list
2. Run `01_download_go.py` to fetch GO annotations
3. Run `02_gbsc_functional_analysis.py` to perform statistical analysis and calulate s-measure
4. Check results in output directory and log file

